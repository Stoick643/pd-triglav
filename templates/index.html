{% extends "base.html" %}

{% block title %}Domov - PD Triglav{% endblock %}

{% block content %}
<div class="row">
    <!-- Hero Section -->
    <div class="col-12">
        <div class="jumbotron bg-light p-5 rounded mb-4">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="display-4">Dobrodošli v PD Triglav!</h1>
                    <p class="lead">
                        Planinsko društvo za ljubitelje gora, narave in druženja. 
                        Odkrivajte slovenski gorski svet z nami.
                    </p>
                    {% if not current_user.is_authenticated %}
                    <div class="mt-4">
                        <a href="{{ url_for('auth.register') }}" class="btn btn-primary btn-lg me-3">
                            Pridruži se nam
                        </a>
                        <a href="{{ url_for('auth.login') }}" class="btn btn-outline-primary btn-lg">
                            Prijava
                        </a>
                    </div>
                    {% elif current_user.is_pending() %}
                    <div class="alert alert-warning mt-4">
                        <i class="bi bi-clock"></i>
                        Vaša registracija čaka na odobritev administratorja.
                    </div>
                    {% else %}
                    <div class="mt-4">
                        <a href="{{ url_for('main.dashboard') }}" class="btn btn-primary btn-lg">
                            Pojdi na nadzorno ploščo
                        </a>
                    </div>
                    {% endif %}
                </div>
                <div class="col-md-4 text-center">
                    <i class="bi bi-mountain display-1 text-primary"></i>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <!-- Quick Info for Non-Members -->
    {% if not current_user.is_authenticated or current_user.is_pending() %}
    <div class="col-md-4">
        <div class="card h-100">
            <div class="card-body">
                <h5 class="card-title">
                    <i class="bi bi-info-circle text-primary"></i> O društvu
                </h5>
                <p class="card-text">
                    PD Triglav združuje planince iz vse Slovenije. Organiziramo izlete, 
                    tečaje in družabne dogodke.
                </p>
                <a href="{{ url_for('main.about') }}" class="btn btn-outline-primary">Več o nas</a>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card h-100">
            <div class="card-body">
                <h5 class="card-title">
                    <i class="bi bi-calendar-event text-success"></i> Prihajajoči izleti
                </h5>
                <p class="card-text">
                    Redno organiziramo izlete za različne stopnje pripravljenosti. 
                    Pridruži se nam!
                </p>
                {% if not current_user.is_authenticated %}
                <small class="text-muted">Prijavi se za dostop do programa izletov.</small>
                {% endif %}
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card h-100">
            <div class="card-body">
                <h5 class="card-title">
                    <i class="bi bi-people text-info"></i> Skupnost
                </h5>
                <p class="card-text">
                    Naša skupnost šteje preko 200 članov. Delimo izkušnje in 
                    fotografije z naših izletov.
                </p>
                {% if not current_user.is_authenticated %}
                <a href="{{ url_for('auth.register') }}" class="btn btn-outline-info">Registriraj se</a>
                {% endif %}
            </div>
        </div>
    </div>
    {% endif %}
    
    <!-- Member Content -->
    {% if current_user.is_authenticated and current_user.can_access_content() %}
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5><i class="bi bi-calendar3"></i> Prihajajoči izleti</h5>
            </div>
            <div class="card-body">
                <p class="text-muted">Trenutno ni objavljenih izletov.</p>
                <!-- This will be populated when we implement trips -->
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5><i class="bi bi-chat-dots"></i> Zadnje objave</h5>
            </div>
            <div class="card-body">
                <p class="text-muted">Ni novih objav.</p>
                <!-- This will be populated when we implement trip reports -->
            </div>
        </div>
    </div>
    {% endif %}
</div>

<!-- Historical Event Section -->
{% if True %} <!-- Temporarily show to everyone for testing -->
<div class="row mt-4">
    <div class="col-12">
        <div class="card border-primary">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">
                    <i class="bi bi-clock-history me-2"></i>Na ta dan v zgodovini
                </h5>
            </div>
            <div class="card-body">
                {% if todays_event %}
                    <div class="row">
                        <div class="col-md-8">
                            <h6 class="text-primary mb-2">
                                {{ todays_event.full_date_string }}
                                <span class="badge bg-{{ 'success' if todays_event.category.value == 'first_ascent' else 'warning' if todays_event.category.value == 'achievement' else 'info' if todays_event.category.value == 'expedition' else 'secondary' if todays_event.category.value == 'discovery' else 'danger' }} ms-2">
                                    {% if todays_event.category.value == 'first_ascent' %}Prva vzpon
                                    {% elif todays_event.category.value == 'achievement' %}Dosežek
                                    {% elif todays_event.category.value == 'expedition' %}Odprava
                                    {% elif todays_event.category.value == 'discovery' %}Odkritje
                                    {% elif todays_event.category.value == 'tragedy' %}Tragedija
                                    {% else %}Dogodek
                                    {% endif %}
                                </span>
                            </h6>
                            <h5 class="mb-3">{{ todays_event.title }}</h5>
                            <p class="mb-3">{{ todays_event.description }}</p>
                            
                            <div class="d-flex flex-wrap gap-3 text-muted small">
                                {% if todays_event.location %}
                                <div>
                                    <i class="bi bi-geo-alt me-1"></i>
                                    <strong>Lokacija:</strong> {{ todays_event.location }}
                                </div>
                                {% endif %}
                                {% if todays_event.people_names %}
                                <div>
                                    <i class="bi bi-people me-1"></i>
                                    <strong>Udeleženci:</strong> {{ todays_event.people_names }}
                                </div>
                                {% endif %}
                            </div>
                            
                            {% if todays_event.url or todays_event.url_secondary %}
                            <div class="mt-3">
                                {% if todays_event.url %}
                                <a href="{{ todays_event.url }}" target="_blank" class="btn btn-outline-primary btn-sm me-2">
                                    <i class="bi bi-link-45deg me-1"></i>Vir 1
                                </a>
                                {% endif %}
                                {% if todays_event.url_secondary %}
                                <a href="{{ todays_event.url_secondary }}" target="_blank" class="btn btn-outline-secondary btn-sm">
                                    <i class="bi bi-link-45deg me-1"></i>Vir 2
                                </a>
                                {% endif %}
                            </div>
                            {% endif %}
                        </div>
                        <div class="col-md-4 text-center d-flex align-items-center justify-content-center">
                            <div class="text-primary">
                                {% if todays_event.category.value == 'first_ascent' %}
                                    <i class="bi bi-mountain display-3"></i>
                                {% elif todays_event.category.value == 'achievement' %}
                                    <i class="bi bi-trophy display-3"></i>
                                {% elif todays_event.category.value == 'expedition' %}
                                    <i class="bi bi-compass display-3"></i>
                                {% elif todays_event.category.value == 'discovery' %}
                                    <i class="bi bi-search display-3"></i>
                                {% elif todays_event.category.value == 'tragedy' %}
                                    <i class="bi bi-heart display-3"></i>
                                {% else %}
                                    <i class="bi bi-calendar-event display-3"></i>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-3 pt-3 border-top">
                        <div class="d-flex justify-content-between align-items-center">
                            <small class="text-muted">
                                <i class="bi bi-robot me-1"></i>
                                Vsebina je bila {{ 'avtomatsko generirana' if todays_event.is_generated else 'ročno dodana' }}
                                {{ todays_event.created_at.strftime('%-d. %-m. %Y') if todays_event.created_at else '' }}
                            </small>
                            <a href="#" class="btn btn-outline-secondary btn-sm">
                                <i class="bi bi-archive me-1"></i>Zgodovina dogodkov
                            </a>
                        </div>
                    </div>
                {% else %}
                    <div class="text-center py-4">
                        <i class="bi bi-clock-history display-4 text-muted mb-3"></i>
                        <h6 class="text-muted">Danes ni zgodovinskih dogodkov</h6>
                        <p class="text-muted">
                            Preverite pozneje ali <a href="#" class="text-decoration-none">povejte nam o dogodku</a>, ki ga poznate.
                        </p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}